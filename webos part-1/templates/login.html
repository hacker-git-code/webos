<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebOS - Modern Login</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #fff;
            color: #000;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .login-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }
        
        .login-container {
            background-color: #fff;
            color: #000;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid #000;
            width: 450px;
            padding: 40px;
            text-align: center;
            transition: all 0.5s ease;
        }
        
        h1 {
            font-size: 42px;
            margin-bottom: 30px;
            font-weight: 700;
        }
        
        h2 {
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .login-layer {
            transition: all 0.3s ease;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #000;
            border-radius: 4px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s ease;
            background-color: #fff;
        }
        
        input:focus {
            border-color: #000;
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
        }
        
        .hint {
            color: #777;
            font-size: 14px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        button {
            background-color: #000;
            color: #fff;
            border: none;
            border-radius: 4px;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        button:hover {
            background-color: #333;
        }
        
        .back-button {
            background-color: #f1f1f1;
            color: #000;
            border: 1px solid #000;
        }
        
        .back-button:hover {
            background-color: #ddd;
        }
        
        .next-button i, .login-button i {
            margin-left: 8px;
        }
        
        .back-button i {
            margin-right: 8px;
        }
        
        .loading {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-message {
            color: #e74c3c;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .error-message i {
            margin-right: 5px;
        }
        
        /* Desktop Interface Styles */
        .desktop {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #f8f8f8;
            overflow: hidden;
            z-index: 999;
        }
        
        /* Make sure the taskbar is visible within the desktop */
        .desktop .taskbar {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2000;
            display: flex;
        }
        
        .desktop-icons {
            padding: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
            grid-gap: 20px;
            max-width: 100%;
        }
        
        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 15px 10px;
            border-radius: 10px;
            transition: all 0.2s ease;
        }
        
        .desktop-icon:hover {
            background-color: rgba(0, 0, 0, 0.05);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .icon-image {
            width: 60px;
            height: 60px;
            background-color: #000;
            color: #fff;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            transition: all 0.2s ease;
            font-size: 26px;
        }
        
        .desktop-icon:hover .icon-image {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }
        
        .icon-name {
            font-size: 13px;
            text-align: center;
            color: #000;
            font-weight: 500;
            max-width: 95px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* App Windows */
        .app-window {
            position: absolute;
            background-color: #fff;
            border: 1px solid #000;
            border-radius: 8px;
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            z-index: 100;
            display: none;
            transition: all 0.3s ease;
            min-width: 400px;
            min-height: 300px;
        }
        
        .app-window.active {
            display: flex;
        }
        
        /* Window header styling */
        .window-header {
            background-color: #000;
            color: #fff;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: move;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }
        
        /* Window controls styling */
        .window-controls {
            display: flex;
            gap: 8px;
            margin-right: 10px;
        }
        
        .window-control {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            position: relative;
            transition: transform 0.2s ease, filter 0.2s ease;
            cursor: pointer;
            z-index: 10;
        }
        
        .window-control:hover {
            transform: scale(1.1);
        }
        
        .window-control:active {
            transform: scale(0.95);
        }
        
        .window-control.close-btn {
            background-color: #ff5f57;
        }
        
        .window-control.minimize-btn {
            background-color: #ffbd2e;
        }
        
        .window-control.maximize-btn {
            background-color: #28c940;
        }
        
        .window-control::before, 
        .window-control::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 1px;
            background: rgba(0, 0, 0, 0);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            transition: transform 0.2s ease, background 0.2s ease;
        }
        
        .window-control.close-btn:hover::before {
            transform: translate(-50%, -50%) scale(1) rotate(45deg);
            background: rgba(0, 0, 0, 0.5);
        }
        
        .window-control.close-btn:hover::after {
            transform: translate(-50%, -50%) scale(1) rotate(-45deg);
            background: rgba(0, 0, 0, 0.5);
        }
        
        .window-control.minimize-btn:hover::before {
            transform: translate(-50%, -50%) scale(1);
            background: rgba(0, 0, 0, 0.5);
        }
        
        .window-control.maximize-btn:hover::before {
            transform: translate(-50%, -50%) scale(1);
            width: 6px;
            height: 6px;
            border: 1px solid rgba(0, 0, 0, 0.5);
            background: transparent;
        }
        
        .window-title {
            flex: 1;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .window-title i {
            font-size: 16px;
        }
        
        .window-content {
            padding: 15px;
            flex: 1;
            overflow: auto;
        }
        
        /* For draggable functionality */
        .app-window.dragging {
            opacity: 0.8;
            pointer-events: none;
        }
        
        /* Calculator button styling */
        .calc-btn {
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            background-color: #f8f8f8;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 4px;
        }
        
        .calc-btn:hover {
            background-color: #eee;
        }
        
        .calc-btn:active {
            background-color: #ddd;
            transform: translateY(1px);
        }
        
        .calc-btn[data-value="="] {
            background-color: #000;
            color: #fff;
        }
        
        .calc-btn[data-value="="]:hover {
            background-color: #333;
        }
        
        .calc-btn[data-value="C"] {
            background-color: #f1f1f1;
        }
        
        /* File Explorer App Styling */
        .file-explorer {
            display: flex;
            height: 100%;
            border: 1px solid #ddd;
        }
        
        .sidebar {
            width: 200px;
            background-color: #f8f8f8;
            border-right: 1px solid #ddd;
            padding: 10px 0;
        }
        
        .sidebar-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sidebar-item:hover {
            background-color: #eee;
        }
        
        .sidebar-item.active {
            background-color: #000;
            color: #fff;
        }
        
        .file-list {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .file-toolbar {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .toolbar-btn {
            padding: 8px 12px;
            border: 1px solid #ddd;
            background-color: #f8f8f8;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .toolbar-btn:hover {
            background-color: #eee;
        }
        
        .search-bar {
            flex: 1;
            display: flex;
            position: relative;
            margin-left: 15px;
        }
        
        .search-bar input {
            width: 100%;
            padding: 8px 12px;
            padding-right: 30px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .search-bar i {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }
        
        .files-container {
            padding: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            overflow-y: auto;
            flex: 1;
        }
        
        .file-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .file-item:hover {
            background-color: #f8f8f8;
        }
        
        .file-item i {
            font-size: 32px;
            margin-bottom: 8px;
        }
        
        .file-item.folder i {
            color: #ffc107;
        }
        
        .file-item.document i {
            color: #2196f3;
        }
        
        .file-item span {
            font-size: 12px;
            text-align: center;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* Browser App Styling */
        .browser-toolbar {
            padding: 10px;
            background-color: #f8f8f8;
            border-bottom: 1px solid #ddd;
            display: flex;
            gap: 10px;
        }
        
        .browser-controls {
            display: flex;
            gap: 5px;
        }
        
        .browser-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            background-color: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .browser-btn:hover {
            background-color: #f1f1f1;
        }
        
        .url-bar {
            flex: 1;
            display: flex;
            position: relative;
        }
        
        .url-bar input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .url-bar button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: #999;
        }
        
        .browser-menu {
            display: flex;
            gap: 5px;
        }
        
        .browser-content {
            height: calc(100% - 54px);
            position: relative;
        }
        
        #browser-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        #browser-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #f8f8f8;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .search-container {
            max-width: 600px;
            text-align: center;
        }
        
        .search-logo {
            font-size: 50px;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .search-input-container {
            position: relative;
            margin-bottom: 30px;
        }
        
        .search-input-container input {
            width: 100%;
            padding: 12px 20px;
            border: 1px solid #ddd;
            border-radius: 30px;
            font-size: 16px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .search-input-container button {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: #999;
        }
        
        .quick-links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .quick-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }
        
        .quick-link-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            transition: all 0.2s;
            font-size: 24px;
        }
        
        .quick-link:hover .quick-link-icon {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transform: translateY(-3px);
        }
        
        /* Calendar App Styling */
        .calendar-toolbar {
            padding: 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .calendar-nav button {
            background: none;
            border: none;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        .calendar-nav button:hover {
            background-color: #f1f1f1;
        }
        
        .calendar-views {
            display: flex;
            gap: 5px;
        }
        
        .view-btn {
            padding: 6px 15px;
            border: 1px solid #ddd;
            background-color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .view-btn:hover {
            background-color: #f1f1f1;
        }
        
        .view-btn.active {
            background-color: #000;
            color: white;
            border-color: #000;
        }
        
        #new-event-btn {
            padding: 8px 15px;
            background-color: #000;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
        }
        
        #new-event-btn:hover {
            background-color: #333;
        }
        
        .calendar-container {
            padding: 15px;
            flex: 1;
        }
        
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            text-align: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            font-weight: 600;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 5px;
            height: calc(100% - 50px);
            margin-top: 5px;
        }
        
        /* Photos App Styling */
        .photos-toolbar {
            padding: 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .toolbar-section {
            display: flex;
            gap: 10px;
        }
        
        .photos-btn {
            padding: 8px 15px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
        }
        
        .photos-btn:hover {
            background-color: #f1f1f1;
        }
        
        .photos-btn.active {
            background-color: #000;
            color: white;
            border-color: #000;
        }
        
        .photos-search {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 20px;
            width: 250px;
        }
        
        .photos-grid {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            overflow-y: auto;
            height: calc(100% - 62px);
        }
        
        .photo-item {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .photo-item:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }
        
        .photo-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            display: block;
        }
        
        /* Settings App Styling */
        .settings-container {
            display: flex;
            height: 100%;
        }
        
        .settings-sidebar {
            width: 200px;
            background-color: #f8f8f8;
            border-right: 1px solid #ddd;
            padding: 20px 0;
        }
        
        .settings-nav-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-nav-item:hover {
            background-color: #eee;
        }
        
        .settings-nav-item.active {
            background-color: #000;
            color: #fff;
        }
        
        .settings-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .settings-section {
            display: none;
        }
        
        .settings-section.active {
            display: block;
        }
        
        .settings-section h2 {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .settings-option {
            margin-bottom: 20px;
        }
        
        .settings-option label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .settings-option select,
        .settings-option input[type="text"],
        .settings-option input[type="color"] {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .range-with-value {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .range-with-value input {
            flex: 1;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #000;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .settings-apply-btn {
            padding: 10px 20px;
            background-color: #000;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 10px;
        }
        
        .settings-apply-btn:hover {
            background-color: #333;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f8f8f8;
            border-radius: 8px;
        }
        
        .user-avatar {
            font-size: 60px;
            color: #999;
        }
        
        .user-details h3 {
            margin-bottom: 5px;
        }
        
        .user-details p {
            color: #666;
        }
        
        .account-btn {
            width: 100%;
            padding: 12px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .account-btn:hover {
            background-color: #f1f1f1;
        }
        
        .about-info {
            margin-bottom: 30px;
            line-height: 1.8;
        }

        /* Taskbar styling */
        .taskbar {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            width: 70%;
            max-width: 700px;
            height: 46px;
            background-color: #000;
            display: none; /* Initially hidden until login */
            align-items: center;
            padding: 0 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            z-index: 2000;
        }
        
        #desktopTaskbar.active {
            display: flex !important;
        }
        
        .start-button {
            background-color: transparent;
            height: 36px;
            width: 36px;
            border-radius: 50%;
            margin-right: 16px;
            transition: all 0.2s ease;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff !important;
        }
        
        .start-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .start-button i {
            font-size: 16px;
            color: #fff !important;
        }
        
        .taskbar-items {
            display: flex;
            align-items: center;
            height: 100%;
            gap: 8px;
            color: #fff !important;
        }
        
        .taskbar-item {
            height: 34px;
            width: 34px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 16px;
            position: relative;
            color: #fff !important;
        }
        
        .taskbar-item i {
            color: #fff !important;
        }
        
        .taskbar-item:hover {
            background-color: rgba(255, 255, 255, 0.15);
            transform: translateY(-3px);
        }
        
        .taskbar-item.active::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background-color: #fff;
            border-radius: 50%;
        }
        
        .system-tray {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 14px;
            padding: 0 10px;
            height: 100%;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            padding-left: 15px;
            margin-left: 15px;
            color: #fff !important;
        }
        
        .system-tray i {
            color: #fff !important;
        }
        
        .time-display {
            color: #fff !important;
            font-size: 13px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        .dropdown-menu {
            position: absolute;
            bottom: 60px;
            left: 10px;
            width: 320px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            padding: 15px;
            display: none;
            flex-direction: column;
            gap: 10px;
            border: 1px solid #000;
            z-index: 1001;
        }
        
        .dropdown-menu.active {
            display: flex;
        }
        
        .dropdown-search {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .dropdown-items {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }
        
        .dropdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .dropdown-item:hover {
            background-color: #f5f5f5;
        }
        
        .dropdown-item i {
            font-size: 24px;
            color: #000;
            margin-bottom: 8px;
        }
        
        .dropdown-item span {
            font-size: 12px;
            color: #000;
            text-align: center;
        }
        
        /* Login transition animation */
        .fade-out {
            opacity: 0;
            transform: scale(0.9);
        }
        
        .login-success-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease;
        }
        
        .login-success-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .login-success-message {
            color: white;
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .login-loader {
            width: 48px;
            height: 48px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        /* Notification Center Styles */
        .notification-center {
            position: fixed;
            top: 0;
            right: 0;
            width: 320px;
            height: 100vh;
            background-color: #fff;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            padding: 0;
            display: none;
            flex-direction: column;
            border-left: 1px solid #000;
            z-index: 1002;
            animation: slideIn 0.3s ease-out;
            overflow: hidden;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #000;
            background-color: #000;
            color: #fff;
        }
        
        .notification-header h3 {
            margin: 0;
            font-size: 16px;
            font-weight: 500;
        }
        
        .notification-controls {
            display: flex;
            gap: 10px;
        }
        
        .clear-btn {
            background-color: transparent;
            color: #fff;
            border: 1px solid #fff;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .clear-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .close-btn {
            background-color: transparent;
            color: #fff;
            border: none;
            border-radius: 4px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .close-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .notification-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .notification-item {
            background-color: #fff;
            border: 1px solid #000;
            border-radius: 6px;
            padding: 12px;
            position: relative;
            transition: all 0.2s;
            cursor: pointer;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .notification-item:hover {
            background-color: #f5f5f5;
        }
        
        .notification-app {
            font-weight: 600;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .notification-app i {
            font-size: 14px;
        }
        
        .notification-title {
            font-weight: 500;
            margin-bottom: 3px;
        }
        
        .notification-message {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .notification-time {
            font-size: 11px;
            color: #999;
            text-align: right;
        }
        
        .notification-close {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 18px;
            height: 18px;
            background-color: transparent;
            border: none;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 50%;
            opacity: 0;
            transition: all 0.2s;
        }
        
        .notification-item:hover .notification-close {
            opacity: 1;
        }
        
        .notification-close:hover {
            background-color: rgba(0, 0, 0, 0.1);
            color: #000;
        }
        
        .notification-empty {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #999;
            height: 100%;
            gap: 10px;
        }
        
        .notification-empty i {
            font-size: 48px;
            opacity: 0.3;
        }
        
        .notification-empty p {
            font-size: 16px;
            margin: 0;
        }
        
        /* Notification Badge */
        .notification-badge {
            position: fixed;
            top: 10px;
            right: 10px;
            background-color: #ff3b30;
            color: white;
            border-radius: 50%;
            min-width: 18px;
            height: 18px;
            padding: 0 5px;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1003;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .notification-badge.show {
            opacity: 1;
        }
        
        /* Notification Toast Container */
        .notification-toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1001;
            pointer-events: none;
        }
        
        .notification-toast {
            background-color: #000;
            color: #fff;
            border-radius: 8px;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            animation: toastIn 0.3s ease-out, toastOut 0.3s ease-in 5.7s;
            width: 300px;
            pointer-events: auto;
            cursor: pointer;
        }
        
        @keyframes toastIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes toastOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        .notification-toast-icon {
            font-size: 20px;
        }
        
        .notification-toast-content {
            flex: 1;
        }
        
        .notification-toast-title {
            font-weight: 600;
            margin-bottom: 3px;
            font-size: 14px;
        }
        
        .notification-toast-message {
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* System tray notification icon */
        .system-tray i.fa-bell {
            cursor: pointer;
            position: relative;
        }
        
        .system-tray i.fa-bell.has-notifications::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 6px;
            height: 6px;
            background-color: #ff3b30;
            border-radius: 50%;
        }
        
        .notification-item.unread {
            border-left: 3px solid #007AFF;
            background-color: #f8f8ff;
        }
        
        /* Rest of notification styling remains the same */
        
        /* Context Menu Styles */
        .context-menu {
            position: fixed;
            background-color: #fff;
            border: 1px solid #000;
            border-radius: 6px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            padding: 6px 0;
            min-width: 180px;
            z-index: 1500;
            opacity: 0;
            transform: scale(0.95);
            transform-origin: top left;
            transition: transform 0.1s ease, opacity 0.1s ease;
            pointer-events: none;
        }
        
        .context-menu.show {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }
        
        .context-menu-item {
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
        }
        
        .context-menu-item:hover {
            background-color: #f5f5f5;
        }
        
        .context-menu-separator {
            height: 1px;
            background-color: #ddd;
            margin: 5px 0;
        }
        
        .context-menu-item i {
            width: 16px;
            text-align: center;
        }
        
        .context-menu-item.disabled {
            opacity: 0.5;
            cursor: default;
        }
        
        .context-menu-item.disabled:hover {
            background-color: transparent;
        }
        
        .context-menu-item .keyboard-shortcut {
            margin-left: auto;
            font-size: 11px;
            color: #777;
            font-family: monospace;
        }
        
        /* Window resize handles */
        .resize-handle {
            position: absolute;
            background: transparent;
            z-index: 90;
        }
        
        .resize-handle.n {
            top: -5px;
            left: 10px;
            right: 10px;
            height: 10px;
            cursor: ns-resize;
        }
        
        .resize-handle.e {
            top: 10px;
            right: -5px;
            bottom: 10px;
            width: 10px;
            cursor: ew-resize;
        }
        
        .resize-handle.s {
            bottom: -5px;
            left: 10px;
            right: 10px;
            height: 10px;
            cursor: ns-resize;
        }
        
        .resize-handle.w {
            top: 10px;
            left: -5px;
            bottom: 10px;
            width: 10px;
            cursor: ew-resize;
        }
        
        .resize-handle.ne {
            top: -5px;
            right: -5px;
            width: 15px;
            height: 15px;
            cursor: ne-resize;
        }
        
        .resize-handle.nw {
            top: -5px;
            left: -5px;
            width: 15px;
            height: 15px;
            cursor: nw-resize;
        }
        
        .resize-handle.se {
            bottom: -5px;
            right: -5px;
            width: 15px;
            height: 15px;
            cursor: se-resize;
        }
        
        .resize-handle.sw {
            bottom: -5px;
            left: -5px;
            width: 15px;
            height: 15px;
            cursor: sw-resize;
        }
        
        .app-window.resizing {
            user-select: none;
            transition: none !important;
        }
        
        /* Window animations */
        .app-window {
            transition: top 0.2s ease, left 0.2s ease, width 0.2s ease, height 0.2s ease, opacity 0.2s ease;
        }
        
        .app-window.maximized {
            transition: all 0.3s ease;
        }
        
        .app-window.closing {
            opacity: 0;
            transform: scale(0.9);
        }
        
        .app-window.opening {
            animation: windowOpen 0.3s ease forwards;
        }
        
        @keyframes windowOpen {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <div class="login-screen">
        <div class="login-container">
            <h1>WebOS</h1>
            <form id="login-form" class="login-form" autocomplete="off">
                <div class="login-layer" id="layer1">
                    <h2>Enter Username</h2>
                    <div class="form-group">
                        <input type="text" name="username" id="username" placeholder="Username" required autofocus>
                    </div>
                    <div class="hint">Enter your username to begin</div>
                    <div class="button-group">
                        <div></div> <!-- Empty div for spacing -->
                        <button type="button" class="next-button" onclick="nextLayer()">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <div class="login-layer" id="layer2" style="display: none;">
                    <h2>Enter Password</h2>
                    <div class="form-group">
                        <input type="password" name="password" id="password" placeholder="Password" required>
                    </div>
                    <div class="hint">Enter your password to continue</div>
                    <div class="button-group">
                        <button type="button" class="back-button" onclick="prevLayer()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button type="button" class="next-button" onclick="nextLayer()">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <div class="login-layer" id="layer3" style="display: none;">
                    <h2>Confirm Password</h2>
                    <div class="form-group">
                        <input type="password" name="confirm_password" id="confirm_password" placeholder="Confirm Password" required>
                    </div>
                    <div class="hint">Re-enter your password to confirm</div>
                    <div class="button-group">
                        <button type="button" class="back-button" onclick="prevLayer()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <button type="button" class="login-button" id="loginButton" onclick="login()">
                            Login <i class="fas fa-sign-in-alt"></i>
                            <div class="loading"></div>
                        </button>
                    </div>
                </div>

                <div id="error-message" class="error-message" style="display: none;">
                    <i class="fas fa-exclamation-circle"></i> <span id="error-text"></span>
                </div>
            </form>
        </div>
    </div>

    <div class="login-success-overlay" id="loginSuccessOverlay">
        <div class="login-success-message">Welcome to WebOS</div>
        <div class="login-loader"></div>
    </div>

    <div class="desktop" id="desktop">
        <div class="desktop-icons">
            <div class="desktop-icon" data-app="documents">
                <div class="icon-image"><i class="fas fa-folder"></i></div>
                <div class="icon-name">Documents</div>
            </div>
            <div class="desktop-icon" data-app="notes">
                <div class="icon-image"><i class="fas fa-file-alt"></i></div>
                <div class="icon-name">Notes</div>
            </div>
            <div class="desktop-icon" data-app="media">
                <div class="icon-image"><i class="fas fa-photo-video"></i></div>
                <div class="icon-name">Media</div>
            </div>
            <div class="desktop-icon" data-app="settings">
                <div class="icon-image"><i class="fas fa-cog"></i></div>
                <div class="icon-name">Settings</div>
            </div>
            <div class="desktop-icon" data-app="trash">
                <div class="icon-image"><i class="fas fa-trash"></i></div>
                <div class="icon-name">Recycle Bin</div>
            </div>
            <div class="desktop-icon" data-app="browser">
                <div class="icon-image"><i class="fas fa-globe"></i></div>
                <div class="icon-name">Browser</div>
            </div>
            <div class="desktop-icon" data-app="mail">
                <div class="icon-image"><i class="fas fa-envelope"></i></div>
                <div class="icon-name">Mail</div>
            </div>
            <div class="desktop-icon" data-app="terminal">
                <div class="icon-image"><i class="fas fa-terminal"></i></div>
                <div class="icon-name">Terminal</div>
            </div>
            <div class="desktop-icon" data-app="calendar">
                <div class="icon-image"><i class="fas fa-calendar-alt"></i></div>
                <div class="icon-name">Calendar</div>
            </div>
            <div class="desktop-icon" data-app="calculator">
                <div class="icon-image"><i class="fas fa-calculator"></i></div>
                <div class="icon-name">Calculator</div>
            </div>
            <div class="desktop-icon" data-app="photos">
                <div class="icon-image"><i class="fas fa-image"></i></div>
                <div class="icon-name">Photos</div>
            </div>
            <div class="desktop-icon" data-app="analytics">
                <div class="icon-image"><i class="fas fa-chart-bar"></i></div>
                <div class="icon-name">Analytics</div>
            </div>
        </div>
        
        <!-- Taskbar implementation -->
        <div class="taskbar" id="desktopTaskbar">
            <button class="start-button" id="startButton">
                <i class="fas fa-th"></i>
            </button>
            <div class="taskbar-items" id="taskbarItems">
                <div class="taskbar-item" data-app="documents">
                    <i class="fas fa-folder"></i>
                </div>
                <div class="taskbar-item" data-app="browser">
                    <i class="fas fa-globe"></i>
                </div>
                <div class="taskbar-item" data-app="mail">
                    <i class="fas fa-envelope"></i>
                </div>
                <div class="taskbar-item" data-app="terminal">
                    <i class="fas fa-terminal"></i>
                </div>
            </div>
            <div class="system-tray">
                <i class="fas fa-wifi"></i>
                <i class="fas fa-volume-up"></i>
                <i class="fas fa-battery-three-quarters"></i>
                <i class="fas fa-bell" id="notificationBell"></i>
                <div class="time-display" id="timeDisplay"></div>
            </div>
        </div>
        
        <!-- App Windows -->
        <div id="app-windows">
            <!-- Documents App -->
            <div class="app-window" id="documents-app" data-app="documents">
                <div class="window-header">
                    <div class="window-title">
                        <i class="fas fa-folder"></i> Documents
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize-btn"></div>
                        <div class="window-control maximize-btn"></div>
                        <div class="window-control close-btn"></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="file-explorer">
                        <div class="sidebar">
                            <div class="sidebar-item active"><i class="fas fa-folder"></i> Documents</div>
                            <div class="sidebar-item"><i class="fas fa-download"></i> Downloads</div>
                            <div class="sidebar-item"><i class="fas fa-image"></i> Pictures</div>
                            <div class="sidebar-item"><i class="fas fa-film"></i> Videos</div>
                            <div class="sidebar-item"><i class="fas fa-music"></i> Music</div>
                        </div>
                        <div class="file-list">
                            <div class="file-toolbar">
                                <button class="toolbar-btn"><i class="fas fa-plus"></i> New</button>
                                <button class="toolbar-btn"><i class="fas fa-upload"></i> Upload</button>
                                <button class="toolbar-btn"><i class="fas fa-download"></i> Download</button>
                                <div class="search-bar">
                                    <input type="text" placeholder="Search files...">
                                    <i class="fas fa-search"></i>
                                </div>
                            </div>
                            <div class="files-container">
                                <div class="file-item folder">
                                    <i class="fas fa-folder"></i>
                                    <span>Projects</span>
                                </div>
                                <div class="file-item folder">
                                    <i class="fas fa-folder"></i>
                                    <span>Personal</span>
                                </div>
                                <div class="file-item document">
                                    <i class="fas fa-file-word"></i>
                                    <span>Resume.docx</span>
                                </div>
                                <div class="file-item document">
                                    <i class="fas fa-file-excel"></i>
                                    <span>Budget.xlsx</span>
                                </div>
                                <div class="file-item document">
                                    <i class="fas fa-file-pdf"></i>
                                    <span>Report.pdf</span>
                                </div>
                                <div class="file-item document">
                                    <i class="fas fa-file-alt"></i>
                                    <span>Notes.txt</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Browser App -->
            <div class="app-window" id="browser-app" data-app="browser">
                <div class="window-header">
                    <div class="window-title">
                        <i class="fas fa-globe"></i> Browser
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize-btn"></div>
                        <div class="window-control maximize-btn"></div>
                        <div class="window-control close-btn"></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="browser-toolbar">
                        <div class="browser-controls">
                            <button id="back-btn" class="browser-btn"><i class="fas fa-arrow-left"></i></button>
                            <button id="forward-btn" class="browser-btn"><i class="fas fa-arrow-right"></i></button>
                            <button id="refresh-btn" class="browser-btn"><i class="fas fa-redo-alt"></i></button>
                            <button id="home-btn" class="browser-btn"><i class="fas fa-home"></i></button>
                        </div>
                        <div class="url-bar">
                            <input type="text" id="url-input" placeholder="Enter URL or search..." value="https://example.com">
                            <button id="go-btn"><i class="fas fa-arrow-right"></i></button>
                        </div>
                        <div class="browser-menu">
                            <button class="browser-btn"><i class="fas fa-bookmark"></i></button>
                            <button class="browser-btn"><i class="fas fa-ellipsis-v"></i></button>
                        </div>
                    </div>
                    <div class="browser-content">
                        <iframe id="browser-iframe" src="about:blank" sandbox="allow-same-origin allow-scripts" title="Browser Content"></iframe>
                        <div id="browser-placeholder">
                            <div class="search-container">
                                <div class="search-logo">WEBOS</div>
                                <div class="search-input-container">
                                    <input type="text" placeholder="Search the web">
                                    <button><i class="fas fa-search"></i></button>
                                </div>
                                <div class="quick-links">
                                    <div class="quick-link">
                                        <div class="quick-link-icon"><i class="fas fa-envelope"></i></div>
                                        <div class="quick-link-text">Mail</div>
                                    </div>
                                    <div class="quick-link">
                                        <div class="quick-link-icon"><i class="fas fa-newspaper"></i></div>
                                        <div class="quick-link-text">News</div>
                                    </div>
                                    <div class="quick-link">
                                        <div class="quick-link-icon"><i class="fas fa-map-marker-alt"></i></div>
                                        <div class="quick-link-text">Maps</div>
                                    </div>
                                    <div class="quick-link">
                                        <div class="quick-link-icon"><i class="fas fa-shopping-cart"></i></div>
                                        <div class="quick-link-text">Shopping</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Calendar App -->
            <div class="app-window" id="calendar-app" data-app="calendar">
                <div class="window-header">
                    <div class="window-title">
                        <i class="fas fa-calendar-alt"></i> Calendar
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize-btn"></div>
                        <div class="window-control maximize-btn"></div>
                        <div class="window-control close-btn"></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="calendar-toolbar">
                        <div class="calendar-nav">
                            <button id="prev-month"><i class="fas fa-chevron-left"></i></button>
                            <h2 id="calendar-month">January 2023</h2>
                            <button id="next-month"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="calendar-views">
                            <button class="view-btn active" data-view="month">Month</button>
                            <button class="view-btn" data-view="week">Week</button>
                            <button class="view-btn" data-view="day">Day</button>
                        </div>
                        <button id="new-event-btn"><i class="fas fa-plus"></i> New Event</button>
                    </div>
                    <div class="calendar-container">
                        <div class="weekdays">
                            <div>Sun</div>
                            <div>Mon</div>
                            <div>Tue</div>
                            <div>Wed</div>
                            <div>Thu</div>
                            <div>Fri</div>
                            <div>Sat</div>
                        </div>
                        <div class="calendar-grid" id="calendar-grid">
                            <!-- Calendar days will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Photos App -->
            <div class="app-window" id="photos-app" data-app="photos">
                <div class="window-header">
                    <div class="window-title">
                        <i class="fas fa-image"></i> Photos
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize-btn"></div>
                        <div class="window-control maximize-btn"></div>
                        <div class="window-control close-btn"></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="photos-toolbar">
                        <div class="toolbar-section">
                            <button class="photos-btn active"><i class="fas fa-th"></i> Gallery</button>
                            <button class="photos-btn"><i class="fas fa-image"></i> Albums</button>
                            <button class="photos-btn"><i class="fas fa-folder"></i> Folders</button>
                        </div>
                        <div class="toolbar-section">
                            <input type="text" placeholder="Search photos..." class="photos-search">
                        </div>
                    </div>
                    <div class="photos-grid">
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+1" alt="Photo 1">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+2" alt="Photo 2">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+3" alt="Photo 3">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+4" alt="Photo 4">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+5" alt="Photo 5">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+6" alt="Photo 6">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+7" alt="Photo 7">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+8" alt="Photo 8">
                        </div>
                        <div class="photo-item">
                            <img src="https://via.placeholder.com/150/000000/FFFFFF/?text=Photo+9" alt="Photo 9">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings App -->
            <div class="app-window" id="settings-app" data-app="settings">
                <div class="window-header">
                    <div class="window-title">
                        <i class="fas fa-cog"></i> Settings
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize-btn"></div>
                        <div class="window-control maximize-btn"></div>
                        <div class="window-control close-btn"></div>
                    </div>
                </div>
                
            <!-- Notes App -->
            <div class="app-window" id="notes-app" data-app="notes">
                <div class="window-header">
                    <div class="window-title">
                        <i class="fas fa-file-alt"></i> Notes
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize-btn"></div>
                        <div class="window-control maximize-btn"></div>
                        <div class="window-control close-btn"></div>
                    </div>
                </div>
                
            <!-- Calculator App -->
            <div class="app-window" id="calculator-app" data-app="calculator">
                <div class="window-header">
                    <div class="window-title">
                        <i class="fas fa-calculator"></i> Calculator
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize-btn"></div>
                        <div class="window-control maximize-btn"></div>
                        <div class="window-control close-btn"></div>
                    </div>
                </div>
                
            <!-- Terminal App -->
            <div class="app-window" id="terminal-app" data-app="terminal">
                <div class="window-header">
                    <div class="window-title">
                        <i class="fas fa-terminal"></i> Terminal
                    </div>
                    <div class="window-controls">
                        <div class="window-control minimize-btn"></div>
                        <div class="window-control maximize-btn"></div>
                        <div class="window-control close-btn"></div>
                    </div>
                </div>
                
        </div>
        
        <div class="dropdown-menu" id="startMenu">
            <input type="text" class="dropdown-search" placeholder="Search apps..." id="appSearch">
            <div class="dropdown-items">
                <div class="dropdown-item" data-app="documents">
                    <i class="fas fa-folder"></i>
                    <span>Documents</span>
                </div>
                <div class="dropdown-item" data-app="notes">
                    <i class="fas fa-file-alt"></i>
                    <span>Notes</span>
                </div>
                <div class="dropdown-item" data-app="browser">
                    <i class="fas fa-globe"></i>
                    <span>Browser</span>
                </div>
                <div class="dropdown-item" data-app="mail">
                    <i class="fas fa-envelope"></i>
                    <span>Mail</span>
                </div>
                <div class="dropdown-item" data-app="terminal">
                    <i class="fas fa-terminal"></i>
                    <span>Terminal</span>
                </div>
                <div class="dropdown-item" data-app="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
                <div class="dropdown-item" data-app="calendar">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Calendar</span>
                </div>
                <div class="dropdown-item" data-app="calculator">
                    <i class="fas fa-calculator"></i>
                    <span>Calculator</span>
                </div>
            </div>
        </div>
        
        <!-- Context Menu -->
        <div class="context-menu" id="contextMenu">
            <!-- Context menu items will be dynamically generated -->
        </div>

        <!-- Notification Center -->
        <div class="notification-center" id="notificationCenter">
            <div class="notification-header">
                <h3>Notifications</h3>
                <div class="notification-controls">
                    <button id="clearAllNotifications" class="clear-btn">Clear All</button>
                    <button id="closeNotifications" class="close-btn"><i class="fas fa-times"></i></button>
                </div>
            </div>
            <div class="notification-list" id="notificationList">
                <!-- Notifications will be added here dynamically -->
            </div>
            <div class="notification-empty" id="notificationEmpty">
                <i class="fas fa-bell-slash"></i>
                <p>No notifications</p>
            </div>
        </div>

        <!-- Notification Badge (shows number of unread notifications) -->
        <div class="notification-badge" id="notificationBadge">0</div>

        <!-- Notification Toast Container (for new notifications) -->
        <div class="notification-toast-container" id="notificationToastContainer">
            <!-- Toast notifications will appear here -->
        </div>
    </div>

    <!-- No global taskbar outside desktop - we're using the main taskbar now -->

    <script>
        let currentLayer = 1;
        const totalLayers = 3;
        // Track window positions
        let zIndex = 100;
        let activeWindows = [];
        // Notification system
        let notifications = [];
        let notificationCount = 0;

        // Notification System Functions
        function initNotificationSystem() {
            // Set up notification center toggle
            const notificationBell = document.getElementById('notificationBell');
            const notificationCenter = document.getElementById('notificationCenter');
            const closeNotificationsBtn = document.getElementById('closeNotifications');
            const clearAllNotificationsBtn = document.getElementById('clearAllNotifications');
            const notificationBadge = document.getElementById('notificationBadge');
            
            // Toggle notification center
            notificationBell.addEventListener('click', () => {
                toggleNotificationCenter();
            });
            
            // Close notification center
            closeNotificationsBtn.addEventListener('click', () => {
                notificationCenter.style.display = 'none';
            });
            
            // Clear all notifications
            clearAllNotificationsBtn.addEventListener('click', () => {
                clearAllNotifications();
            });
            
            // Close notification center when clicking outside
            document.addEventListener('click', (e) => {
                if (notificationCenter.style.display === 'flex' && 
                    !notificationCenter.contains(e.target) && 
                    e.target !== notificationBell) {
                    notificationCenter.style.display = 'none';
                }
            });
            
            // Add some demo notifications after a delay
            setTimeout(() => {
                addNotification('System', 'Welcome to WebOS', 'Your session has started successfully.', 'fa-desktop');
            }, 3000);
            
            setTimeout(() => {
                addNotification('Mail', 'New email received', 'You have 3 unread messages in your inbox.', 'fa-envelope');
            }, 8000);
            
            setTimeout(() => {
                addNotification('Calendar', 'Upcoming event', 'Meeting with team at 2:00 PM today.', 'fa-calendar-alt');
            }, 15000);
            
            // Set up notifications from apps
            testAppNotifications();
        }
        
        function toggleNotificationCenter() {
            const notificationCenter = document.getElementById('notificationCenter');
            
            if (notificationCenter.style.display === 'flex') {
                notificationCenter.style.display = 'none';
            } else {
                notificationCenter.style.display = 'flex';
                updateNotificationCenter();
                markAllNotificationsAsRead();
            }
        }
        
        function addNotification(app, title, message, iconClass) {
            const id = Date.now(); // Unique ID for the notification
            const timestamp = new Date();
            
            // Create notification object
            const notification = {
                id: id,
                app: app,
                title: title,
                message: message,
                iconClass: iconClass || 'fa-bell',
                timestamp: timestamp,
                read: false
            };
            
            // Add to notifications array
            notifications.unshift(notification);
            
            // Update notification count
            updateNotificationCount();
            
            // Show toast notification
            showToastNotification(notification);
            
            // Update notification center if it's open
            if (document.getElementById('notificationCenter').style.display === 'flex') {
                updateNotificationCenter();
            }
            
            return id;
        }
        
        function removeNotification(id) {
            const index = notifications.findIndex(notification => notification.id === id);
            
            if (index !== -1) {
                notifications.splice(index, 1);
                updateNotificationCount();
                updateNotificationCenter();
            }
        }
        
        function clearAllNotifications() {
            notifications = [];
            notificationCount = 0;
            updateNotificationCount();
            updateNotificationCenter();
        }
        
        function markAllNotificationsAsRead() {
            notifications.forEach(notification => {
                notification.read = true;
            });
            
            notificationCount = 0;
            updateNotificationCount();
        }
        
        function updateNotificationCount() {
            const unreadCount = notifications.filter(notification => !notification.read).length;
            notificationCount = unreadCount;
            
            const notificationBadge = document.getElementById('notificationBadge');
            const notificationBell = document.getElementById('notificationBell');
            
            if (unreadCount > 0) {
                notificationBadge.textContent = unreadCount > 9 ? '9+' : unreadCount;
                notificationBadge.classList.add('show');
                notificationBell.classList.add('has-notifications');
            } else {
                notificationBadge.classList.remove('show');
                notificationBell.classList.remove('has-notifications');
            }
        }
        
        function updateNotificationCenter() {
            const notificationList = document.getElementById('notificationList');
            const notificationEmpty = document.getElementById('notificationEmpty');
            
            // Clear the list
            notificationList.innerHTML = '';
            
            if (notifications.length === 0) {
                notificationEmpty.style.display = 'flex';
                return;
            }
            
            notificationEmpty.style.display = 'none';
            
            // Add notifications to the list
            notifications.forEach(notification => {
                const notificationElement = createNotificationElement(notification);
                notificationList.appendChild(notificationElement);
            });
        }
        
        function createNotificationElement(notification) {
            const element = document.createElement('div');
            element.className = 'notification-item';
            element.setAttribute('data-id', notification.id);
            
            if (!notification.read) {
                element.classList.add('unread');
            }
            
            // Format the time
            const timeString = formatNotificationTime(notification.timestamp);
            
            element.innerHTML = `
                <div class="notification-app">
                    <i class="fas ${notification.iconClass}"></i>
                    ${notification.app}
                </div>
                <div class="notification-title">${notification.title}</div>
                <div class="notification-message">${notification.message}</div>
                <div class="notification-time">${timeString}</div>
                <button class="notification-close"><i class="fas fa-times"></i></button>
            `;
            
            // Add event listeners
            element.querySelector('.notification-close').addEventListener('click', (e) => {
                e.stopPropagation();
                removeNotification(notification.id);
            });
            
            element.addEventListener('click', () => {
                // Mark as read
                notification.read = true;
                updateNotificationCount();
                
                // Handle click based on app
                handleNotificationClick(notification);
            });
            
            return element;
        }
        
        function handleNotificationClick(notification) {
            // Close notification center
            document.getElementById('notificationCenter').style.display = 'none';
            
            // Launch the relevant app
            switch (notification.app.toLowerCase()) {
                case 'mail':
                    launchApp('mail');
                    break;
                case 'calendar':
                    launchApp('calendar');
                    break;
                case 'system':
                    // For system notifications, we could open settings or do nothing
                    break;
                default:
                    // Try to launch an app with the same name if it exists
                    const appName = notification.app.toLowerCase();
                    const appElement = document.querySelector(`.desktop-icon[data-app="${appName}"]`);
                    
                    if (appElement) {
                        launchApp(appName);
                    }
            }
        }
        
        function showToastNotification(notification) {
            const toastContainer = document.getElementById('notificationToastContainer');
            
            const toast = document.createElement('div');
            toast.className = 'notification-toast';
            toast.setAttribute('data-id', notification.id);
            
            toast.innerHTML = `
                <div class="notification-toast-icon">
                    <i class="fas ${notification.iconClass}"></i>
                </div>
                <div class="notification-toast-content">
                    <div class="notification-toast-title">${notification.app}: ${notification.title}</div>
                    <div class="notification-toast-message">${notification.message}</div>
                </div>
            `;
            
            // Add click event to open the related app
            toast.addEventListener('click', () => {
                handleNotificationClick(notification);
                
                // Remove the toast
                toast.remove();
            });
            
            toastContainer.appendChild(toast);
            
            // Remove the toast after animation completes (6 seconds total)
            setTimeout(() => {
                if (toast.parentNode === toastContainer) {
                    toastContainer.removeChild(toast);
                }
            }, 6000);
        }
        
        function formatNotificationTime(timestamp) {
            const now = new Date();
            const diff = now - timestamp; // difference in milliseconds
            
            // If less than a minute ago
            if (diff < 60000) {
                return 'Just now';
            }
            
            // If less than an hour ago
            if (diff < 3600000) {
                const minutes = Math.floor(diff / 60000);
                return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
            }
            
            // If less than a day ago
            if (diff < 86400000) {
                const hours = Math.floor(diff / 3600000);
                return `${hours} hour${hours > 1 ? 's' : ''} ago`;
            }
            
            // If less than a week ago
            if (diff < 604800000) {
                const days = Math.floor(diff / 86400000);
                return `${days} day${days > 1 ? 's' : ''} ago`;
            }
            
            // Otherwise show the actual date
            return timestamp.toLocaleDateString();
        }

        function nextLayer() {
            if (currentLayer < totalLayers) {
                document.getElementById(`layer${currentLayer}`).style.display = 'none';
                currentLayer++;
                document.getElementById(`layer${currentLayer}`).style.display = 'block';
                document.querySelector(`#layer${currentLayer} input`).focus();
            }
        }

        function prevLayer() {
            if (currentLayer > 1) {
                document.getElementById(`layer${currentLayer}`).style.display = 'none';
                currentLayer--;
                document.getElementById(`layer${currentLayer}`).style.display = 'block';
                document.querySelector(`#layer${currentLayer} input`).focus();
            }
        }

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm_password').value;
            
            // Clear any previous errors
            hideError();
            
            // Validate input
            if (!username) {
                showError("Username cannot be empty");
                return;
            }
            
            if (!password) {
                showError("Password cannot be empty");
                return;
            }
            
            if (password !== confirmPassword) {
                showError("Passwords do not match");
                return;
            }

            // Show loading state
            const loginButton = document.getElementById('loginButton');
            const loading = loginButton.querySelector('.loading');
            loginButton.disabled = true;
            loading.style.display = 'inline-block';
            
            // Simulate login (normally this would be an AJAX request)
            setTimeout(() => {
                // Show success message and transition to desktop
                document.getElementById('loginSuccessOverlay').classList.add('show');
                
                // Hide login container with animation
                document.querySelector('.login-container').classList.add('fade-out');
                
                // After showing the loading overlay, transition to desktop
                setTimeout(() => {
                    document.getElementById('loginSuccessOverlay').classList.remove('show');
                    document.querySelector('.login-screen').style.display = 'none';
                    
                    // Show desktop
                    const desktop = document.getElementById('desktop');
                    desktop.style.display = 'block';
                    
                    // Show taskbar
                    const desktopTaskbar = document.getElementById('desktopTaskbar');
                    desktopTaskbar.classList.add('active');
                    
                    // Initialize desktop (which will show the taskbar)
                    initDesktop();
                    
                    // Update clock
                    updateClock();
                }, 2000);
            }, 1500);
        }
        
        function showError(message) {
            const errorMessage = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');
            
            errorText.textContent = message;
            errorMessage.style.display = 'flex';
        }
        
        function hideError() {
            document.getElementById('error-message').style.display = 'none';
        }
        
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            document.getElementById('timeDisplay').textContent = timeString;
        }

        // Desktop functionality
        function initDesktop() {
            // Make the taskbar visible
            const desktopTaskbar = document.getElementById('desktopTaskbar');
            
            // Add active class to ensure visibility
            desktopTaskbar.classList.add('active');
            
            // Explicitly set display flex with !important
            desktopTaskbar.style.display = 'flex';
            desktopTaskbar.style.setProperty('display', 'flex', 'important');
            desktopTaskbar.style.opacity = '1';
            desktopTaskbar.style.visibility = 'visible';
            
            // Initialize notification system
            initNotificationSystem();
            
            // Initialize context menu system
            initContextMenuSystem();
            
            // Start menu toggle
            const startButton = document.getElementById('startButton');
            const startMenu = document.getElementById('startMenu');
            
            startButton.addEventListener('click', () => {
                startMenu.classList.toggle('active');
            });
            
            // Close start menu when clicking elsewhere
            document.addEventListener('click', (e) => {
                if (!startButton.contains(e.target) && !startMenu.contains(e.target)) {
                    startMenu.classList.remove('active');
                }
            });
            
            // Update clock on both taskbars
            updateAllClocks();
            setInterval(updateAllClocks, 1000);
            
            // App search functionality
            const appSearch = document.getElementById('appSearch');
            const dropdownItems = document.querySelectorAll('.dropdown-item');
            
            appSearch.addEventListener('input', () => {
                const searchValue = appSearch.value.toLowerCase();
                
                dropdownItems.forEach(item => {
                    const appName = item.querySelector('span').textContent.toLowerCase();
                    if (appName.includes(searchValue)) {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });

            // Desktop icon click
            const desktopIcons = document.querySelectorAll('.desktop-icon');
            desktopIcons.forEach(icon => {
                icon.addEventListener('click', () => {
                    const app = icon.getAttribute('data-app');
                    launchApp(app);
                });
            });
            
            // Setup both taskbars' item clicks
            setupTaskbarItemClicks('#desktopTaskbar');
            setupTaskbarItemClicks('#globalTaskbar');
            
            // Start menu app click
            dropdownItems.forEach(item => {
                item.addEventListener('click', () => {
                    const app = item.getAttribute('data-app');
                    launchApp(app);
                    startMenu.classList.remove('active');
                });
            });
            
            // Initialize window controls
            initWindowControls();
            
            // Initialize calculator
            initCalculator();
            
            // Initialize terminal
            initTerminal();
            
            // Initialize calendar
            initCalendar();
            
            // Initialize settings
            initSettings();
            
            // Initialize browser
            initBrowser();
            
            // Initialize documents
            initDocuments();
            
            // Initialize photos
            initPhotos();
        }
        
        // Helper function to setup taskbar item clicks
        function setupTaskbarItemClicks(taskbarSelector) {
            const taskbarItems = document.querySelectorAll(`${taskbarSelector} .taskbar-item`);
            taskbarItems.forEach(item => {
                item.addEventListener('click', () => {
                    const app = item.getAttribute('data-app');
                    
                    // Toggle active state
                    if (item.classList.contains('active')) {
                        item.classList.remove('active');
                        minimizeApp(app);
                    } else {
                        // Remove active from all taskbar items in both taskbars
                        document.querySelectorAll('.taskbar-item').forEach(i => i.classList.remove('active'));
                        
                        // Add active to this item and its counterpart in the other taskbar
                        item.classList.add('active');
                        const counterpartSelector = taskbarSelector === '#desktopTaskbar' ? '#globalTaskbar' : '#desktopTaskbar';
                        const counterpart = document.querySelector(`${counterpartSelector} .taskbar-item[data-app="${app}"]`);
                        if (counterpart) counterpart.classList.add('active');
                        
                        launchApp(app);
                    }
                });
            });
        }
        
        // Update both clocks
        function updateAllClocks() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            document.getElementById('timeDisplay').textContent = timeString;
            document.getElementById('globalTimeDisplay').textContent = timeString;
        }
        
        function updateClock() {
            updateAllClocks();
        }
        
        // Window management functions
        function initWindowControls() {
            // Add event listeners to window controls
            document.querySelectorAll('.window-control').forEach(control => {
                // Visual feedback on hover
                control.addEventListener('mouseenter', () => {
                    control.style.transform = 'scale(1.1)';
                });
                
                control.addEventListener('mouseleave', () => {
                    control.style.transform = '';
                });
                
                // Handle clicks on controls
                control.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const action = control.getAttribute('data-action') || control.classList.contains('close-btn') ? 'close' : 
                                                                       control.classList.contains('minimize-btn') ? 'minimize' : 
                                                                       control.classList.contains('maximize-btn') ? 'maximize' : null;
                    if (!action) return;
                    
                    const window = control.closest('.app-window');
                    const app = window.getAttribute('data-app');
                    
                    // Visual feedback on click
                    control.style.transform = 'scale(0.9)';
                    setTimeout(() => {
                        control.style.transform = '';
                        
                        // Perform action
                        if (action === 'close') {
                            closeWindow(app);
                        } else if (action === 'minimize') {
                            minimizeApp(app);
                        } else if (action === 'maximize') {
                            toggleMaximize(app);
                        }
                    }, 100);
                });
            });
            
            // Make windows draggable
            document.querySelectorAll('.window-header').forEach(header => {
                makeWindowDraggable(header.closest('.app-window'), header);
            });
            
            // Make windows resizable
            document.querySelectorAll('.app-window').forEach(window => {
                addResizeHandles(window);
            });
            
            // Window focus management
            document.querySelectorAll('.app-window').forEach(window => {
                window.addEventListener('mousedown', () => {
                    bringWindowToFront(window.getAttribute('data-app'));
                });
            });
        }
        
        // Function to add resize handles to a window
        function addResizeHandles(window) {
            // Create 8 resize handles (n, e, s, w, ne, nw, se, sw)
            const positions = ['n', 'e', 's', 'w', 'ne', 'nw', 'se', 'sw'];
            
            positions.forEach(pos => {
                // Create the handle element
                const handle = document.createElement('div');
                handle.className = `resize-handle ${pos}`;
                handle.setAttribute('data-resize', pos);
                
                // Add the handle to the window
                window.appendChild(handle);
                
                // Make it resizable
                makeResizable(window, handle, pos);
            });
        }
        
        // Function to make an element resizable
        function makeResizable(window, handle, position) {
            let startX, startY, startWidth, startHeight, startTop, startLeft;
            let isResizing = false;
            
            // Add hardware acceleration hint
            window.style.willChange = 'width, height';
            
            handle.addEventListener('mousedown', (e) => {
                e.preventDefault();
                e.stopPropagation();
                
                // Start resizing
                isResizing = true;
                window.classList.add('resizing');
                
                // Get initial cursor position
                startX = e.clientX;
                startY = e.clientY;
                
                // Get initial window dimensions
                const rect = window.getBoundingClientRect();
                startWidth = rect.width;
                startHeight = rect.height;
                startTop = rect.top;
                startLeft = rect.left;
                
                // Bring window to front
                bringWindowToFront(window.getAttribute('data-app'));
                
                // Use requestAnimationFrame for smoother resizing
                requestAnimationFrame(() => updateSize(e.clientX, e.clientY));
                
                // Add mouse move and mouse up event listeners
                document.addEventListener('mousemove', resizeMove);
                document.addEventListener('mouseup', resizeEnd);
            });
            
            function resizeMove(e) {
                e.preventDefault();
                updateSize(e.clientX, e.clientY);
            }
            
            function updateSize(clientX, clientY) {
                if (!isResizing) return;
                
                // Calculate how much the mouse has moved
                const dx = clientX - startX;
                const dy = clientY - startY;
                
                // Minimum size constraints
                const minWidth = 250;
                const minHeight = 200;
                
                // Resize based on which handle is being dragged
                if (position.includes('e')) {
                    const newWidth = Math.max(minWidth, startWidth + dx);
                    window.style.width = `${newWidth}px`;
                }
                
                if (position.includes('s')) {
                    const newHeight = Math.max(minHeight, startHeight + dy);
                    window.style.height = `${newHeight}px`;
                }
                
                if (position.includes('w')) {
                    const newWidth = Math.max(minWidth, startWidth - dx);
                    if (newWidth !== minWidth) {
                        window.style.width = `${newWidth}px`;
                        window.style.left = `${startLeft + dx}px`;
                    }
                }
                
                if (position.includes('n')) {
                    const newHeight = Math.max(minHeight, startHeight - dy);
                    if (newHeight !== minHeight) {
                        window.style.height = `${newHeight}px`;
                        window.style.top = `${startTop + dy}px`;
                    }
                }
                
                // Request next frame
                requestAnimationFrame(() => updateSize(clientX, clientY));
            }
            
            function resizeEnd() {
                // Stop resizing
                isResizing = false;
                window.classList.remove('resizing');
                
                // Remove event listeners
                document.removeEventListener('mousemove', resizeMove);
                document.removeEventListener('mouseup', resizeEnd);
            }
        }
        
        function bringWindowToFront(app) {
            const appWindow = document.querySelector(`.app-window[data-app="${app}"]`);
            if (!appWindow) return;
            
            zIndex += 1;
            appWindow.style.zIndex = zIndex;
            
            // Update active state
            document.querySelectorAll('.app-window').forEach(win => {
                win.classList.remove('focused');
            });
            appWindow.classList.add('focused');
            
            // Update taskbar
            document.querySelectorAll('.taskbar-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-app') === app) {
                    item.classList.add('active');
                }
            });
        }
        
        function toggleMaximize(app) {
            const appWindow = document.querySelector(`.app-window[data-app="${app}"]`);
            if (!appWindow) return;
            
            if (appWindow.classList.contains('maximized')) {
                // Restore window with animation
                appWindow.style.transition = 'all 0.3s ease';
                appWindow.classList.remove('maximized');
                
                // Restore previous position and size
                appWindow.style.top = appWindow.getAttribute('data-prev-top') || '50px';
                appWindow.style.left = appWindow.getAttribute('data-prev-left') || '50px';
                appWindow.style.width = appWindow.getAttribute('data-prev-width') || '600px';
                appWindow.style.height = appWindow.getAttribute('data-prev-height') || '400px';
                
                // Enable resize handles
                appWindow.querySelectorAll('.resize-handle').forEach(handle => {
                    handle.style.display = '';
                });
                
                // Update taskbar icon
                const taskbarItem = document.querySelector(`.taskbar-item[data-app="${app}"]`);
                if (taskbarItem) {
                    taskbarItem.classList.remove('maximized');
                }
                
                // Remove transition after animation completes
                setTimeout(() => {
                    appWindow.style.transition = '';
                }, 300);
            } else {
                // Save current position and size
                appWindow.setAttribute('data-prev-top', appWindow.style.top);
                appWindow.setAttribute('data-prev-left', appWindow.style.left);
                appWindow.setAttribute('data-prev-width', appWindow.style.width);
                appWindow.setAttribute('data-prev-height', appWindow.style.height);
                
                // Maximize with animation
                appWindow.style.transition = 'all 0.3s ease';
                appWindow.classList.add('maximized');
                
                // Set maximized position and size
                appWindow.style.top = '0';
                appWindow.style.left = '0';
                appWindow.style.width = '100%';
                appWindow.style.height = 'calc(100% - 46px)';
                
                // Hide resize handles
                appWindow.querySelectorAll('.resize-handle').forEach(handle => {
                    handle.style.display = 'none';
                });
                
                // Update taskbar icon
                const taskbarItem = document.querySelector(`.taskbar-item[data-app="${app}"]`);
                if (taskbarItem) {
                    taskbarItem.classList.add('maximized');
                }
                
                // Remove transition after animation completes
                setTimeout(() => {
                    appWindow.style.transition = '';
                }, 300);
            }
        }
        
        // App management
        function launchApp(app) {
            console.log(`Launching app: ${app}`);
            
            const appWindow = document.querySelector(`.app-window[data-app="${app}"]`);
            if (appWindow) {
                // If window already exists, show it
                if (appWindow.classList.contains('active')) {
                    // If already active, just bring to front
                    bringWindowToFront(app);
                } else {
                    // Show the window with animation
                    appWindow.classList.add('active');
                    appWindow.classList.add('opening');
                    bringWindowToFront(app);
                    
                    // Remove animation class after it completes
                    setTimeout(() => {
                        appWindow.classList.remove('opening');
                    }, 300);
                    
                    // Set initial position if not set
                    if (!appWindow.style.top) {
                        const randomTop = Math.floor(Math.random() * 100) + 50;
                        const randomLeft = Math.floor(Math.random() * 100) + 50;
                        appWindow.style.top = `${randomTop}px`;
                        appWindow.style.left = `${randomLeft}px`;
                    }
                }
            } else {
                // For apps without a window implementation, show a placeholder
                if (!['notes', 'calculator', 'terminal'].includes(app)) {
                    alert(`The ${app} app is not implemented yet.`);
                }
            }
            
            // Update both taskbars - make the app icon active
            updateTaskbarsForApp(app, true);
            
            // Add app to taskbar if not already there
            const taskbarItemsContainer = document.getElementById('taskbarItems');
            const globalTaskbarItemsContainer = document.getElementById('globalTaskbarItems');
            let appInTaskbar = false;
            
            document.querySelectorAll('#desktopTaskbar .taskbar-item').forEach(item => {
                if (item.getAttribute('data-app') === app) {
                    appInTaskbar = true;
                }
            });
            
            if (!appInTaskbar) {
                // Find icon from desktop
                const desktopIcon = document.querySelector(`.desktop-icon[data-app="${app}"]`);
                if (desktopIcon) {
                    const iconClass = desktopIcon.querySelector('i').className;
                    
                    // Add to desktop taskbar
                    const newTaskbarItem = createTaskbarItem(app, iconClass);
                    taskbarItemsContainer.appendChild(newTaskbarItem);
                    
                    // Add to global taskbar
                    const newGlobalTaskbarItem = createTaskbarItem(app, iconClass);
                    globalTaskbarItemsContainer.appendChild(newGlobalTaskbarItem);
                    
                    // Setup event listeners for both new items
                    setupNewTaskbarItemEvents(newTaskbarItem, app);
                    setupNewTaskbarItemEvents(newGlobalTaskbarItem, app);
                }
            }
            
            // Add to active windows array if not there
            if (!activeWindows.includes(app)) {
                activeWindows.push(app);
            }
        }
        
        function createTaskbarItem(app, iconClass) {
            const item = document.createElement('div');
            item.className = 'taskbar-item active';
            item.setAttribute('data-app', app);
            item.innerHTML = `<i class="${iconClass}"></i>`;
            return item;
        }
        
        function setupNewTaskbarItemEvents(item, app) {
            item.addEventListener('click', () => {
                if (item.classList.contains('active')) {
                    updateTaskbarsForApp(app, false);
                    minimizeApp(app);
                } else {
                    updateTaskbarsForApp(app, true);
                    launchApp(app);
                }
            });
        }
        
        function updateTaskbarsForApp(app, isActive) {
            // Update taskbar
            document.querySelectorAll('.taskbar-item').forEach(item => {
                if (item.getAttribute('data-app') === app) {
                    if (isActive) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                } else if (isActive) {
                    item.classList.remove('active');
                }
            });
        }
        
        function minimizeApp(app) {
            console.log(`Minimizing app: ${app}`);
            const appWindow = document.querySelector(`.app-window[data-app="${app}"]`);
            if (appWindow) {
                appWindow.classList.remove('active');
            }
            
            // Update both taskbars
            updateTaskbarsForApp(app, false);
        }
        
        function closeWindow(app) {
            console.log(`Closing app: ${app}`);
            const appWindow = document.querySelector(`.app-window[data-app="${app}"]`);
            if (appWindow) {
                // Animate closing
                appWindow.classList.add('closing');
                
                // Wait for animation to complete before hiding
                setTimeout(() => {
                    appWindow.classList.remove('active');
                    appWindow.classList.remove('closing');
                    
                    // Remove from active windows
                    const index = activeWindows.indexOf(app);
                    if (index > -1) {
                        activeWindows.splice(index, 1);
                    }
                    
                    // Update both taskbars
                    updateTaskbarsForApp(app, false);
                    
                    // Remove from taskbar if not a default app
                    const defaultApps = ['documents', 'browser', 'mail', 'terminal'];
                    if (!defaultApps.includes(app)) {
                        // Remove from desktop taskbar
                        const taskbarItem = document.querySelector(`#desktopTaskbar .taskbar-item[data-app="${app}"]`);
                        if (taskbarItem) {
                            taskbarItem.remove();
                        }
                        
                        // Remove from global taskbar
                        const globalTaskbarItem = document.querySelector(`#globalTaskbar .taskbar-item[data-app="${app}"]`);
                        if (globalTaskbarItem) {
                            globalTaskbarItem.remove();
                        }
                    }
                }, 300);
            }
        }
        
        // Initialize Calculator
        function initCalculator() {
            const display = document.getElementById('calc-display');
            const buttons = document.querySelectorAll('.calc-btn');
            let currentValue = '';
            
            if (!display || buttons.length === 0) return;
            
            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    const value = button.getAttribute('data-value');
                    
                    if (value === 'C') {
                        // Clear
                        currentValue = '';
                        display.value = '';
                    } else if (value === '=') {
                        // Calculate
                        try {
                            currentValue = eval(currentValue).toString();
                            display.value = currentValue;
                        } catch (e) {
                            display.value = 'Error';
                            currentValue = '';
                        }
                    } else {
                        // Add to expression
                        currentValue += value;
                        display.value = currentValue;
                    }
                });
            });
        }
        
        // Initialize Terminal
        function initTerminal() {
            const terminal = document.getElementById('terminal-app');
            const input = document.getElementById('terminal-input');
            const output = document.getElementById('terminal-output');
            
            if (!terminal || !input || !output) return;
            
            // Focus input when terminal is clicked
            terminal.addEventListener('click', () => {
                input.focus();
            });
            
            // Handle terminal commands
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const command = input.value;
                    output.innerHTML += `<br>${command}`;
                    
                    // Process command
                    let response = '';
                    if (command === 'help') {
                        response = 'Available commands: help, clear, date, echo, whoami';
                    } else if (command === 'clear') {
                        output.innerHTML = 'Terminal cleared<br>&gt;';
                        input.value = '';
                        return;
                    } else if (command === 'date') {
                        response = new Date().toString();
                    } else if (command.startsWith('echo ')) {
                        response = command.substring(5);
                    } else if (command === 'whoami') {
                        response = 'WebOS User';
                    } else if (command === '') {
                        response = '';
                    } else {
                        response = `Command not found: ${command}`;
                    }
                    
                    output.innerHTML += `<br>${response}<br>&gt;`;
                    input.value = '';
                    
                    // Scroll to bottom
                    terminal.querySelector('.window-content').scrollTop = terminal.querySelector('.window-content').scrollHeight;
                }
            });
        }

        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                if (currentLayer < totalLayers) {
                    nextLayer();
                } else if (currentLayer === totalLayers) {
                    login();
                }
            } else if (e.key === 'Escape') {
                if (currentLayer > 1) {
                    prevLayer();
                }
            }
        });

        // Add input validation highlighting
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', function() {
                this.style.borderColor = this.value ? '#000' : '#ddd';
                hideError();
            });
        });

        // Function to update time display
        function updateTimeDisplay() {
            const timeDisplay = document.getElementById('timeDisplay');
            if (timeDisplay) {
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                timeDisplay.textContent = `${hours}:${minutes}`;
            }
        }

        // Update time immediately and then every minute
        updateTimeDisplay();
        setInterval(updateTimeDisplay, 60000);

        // Simulated login logic for demo purposes
        document.addEventListener('DOMContentLoaded', function() {
            const loginButton = document.querySelector('.login-button');
            if (loginButton) {
                loginButton.addEventListener('click', function() {
                    const loginScreen = document.querySelector('.login-screen');
                    const desktop = document.getElementById('desktop');
                    
                    if (loginScreen && desktop) {
                        loginScreen.style.display = 'none';
                        desktop.style.display = 'block';
                        
                        // Make sure taskbars are visible
                        const desktopTaskbar = document.getElementById('desktopTaskbar');
                        const globalTaskbar = document.getElementById('globalTaskbar');
                        
                        desktopTaskbar.style.display = 'flex';
                        desktopTaskbar.style.opacity = '1';
                        desktopTaskbar.style.visibility = 'visible';
                        desktopTaskbar.style.setProperty('display', 'flex', 'important');
                        
                        globalTaskbar.style.display = 'flex';
                        globalTaskbar.style.opacity = '1';
                        globalTaskbar.style.visibility = 'visible';
                        globalTaskbar.style.setProperty('display', 'flex', 'important');
                        
                        initDesktop();
                    }
                });
            }
            
            // Ensure global taskbar is visible at all times
            const globalTaskbar = document.getElementById('globalTaskbar');
            if (globalTaskbar) {
                globalTaskbar.style.display = 'flex';
                globalTaskbar.style.opacity = '1';
                globalTaskbar.style.visibility = 'visible';
                globalTaskbar.style.setProperty('display', 'flex', 'important');
            }
        });

        // Calendar app functionality
        function initCalendar() {
            const calendarApp = document.getElementById('calendar-app');
            if (!calendarApp) return;
            
            const monthDisplay = document.getElementById('calendar-month');
            const calendarGrid = document.getElementById('calendar-grid');
            const prevMonthBtn = document.getElementById('prev-month');
            const nextMonthBtn = document.getElementById('next-month');
            const viewBtns = document.querySelectorAll('.view-btn');
            const newEventBtn = document.getElementById('new-event-btn');
            
            let currentDate = new Date();
            let currentView = 'month';
            
            // Update view buttons
            viewBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    viewBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentView = btn.getAttribute('data-view');
                    renderCalendar();
                });
            });
            
            // Next/Previous month buttons
            prevMonthBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });
            
            nextMonthBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });
            
            // New event button
            newEventBtn.addEventListener('click', () => {
                alert('New event functionality would go here');
            });
            
            // Render the calendar
            function renderCalendar() {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                
                // Update month display
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                monthDisplay.textContent = `${monthNames[month]} ${year}`;
                
                // Clear the grid
                calendarGrid.innerHTML = '';
                
                // Get first day of month and last day
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                
                // Get day of week of first day (0-6)
                const firstDayOfWeek = firstDay.getDay();
                
                // Fill the calendar grid
                // First, fill in empty cells for days before the 1st
                for (let i = 0; i < firstDayOfWeek; i++) {
                    const emptyCell = document.createElement('div');
                    emptyCell.className = 'calendar-day empty';
                    calendarGrid.appendChild(emptyCell);
                }
                
                // Fill in the days of the month
                for (let day = 1; day <= lastDay.getDate(); day++) {
                    const cell = document.createElement('div');
                    cell.className = 'calendar-day';
                    
                    // Check if this is today
                    const todayDate = new Date();
                    if (day === todayDate.getDate() && month === todayDate.getMonth() && year === todayDate.getFullYear()) {
                        cell.classList.add('today');
                        cell.style.backgroundColor = '#f0f0f0';
                        cell.style.fontWeight = 'bold';
                        cell.style.border = '1px solid #000';
                        cell.style.color = '#000';
                    }
                    
                    // Day number
                    const dayNumber = document.createElement('div');
                    dayNumber.className = 'day-number';
                    dayNumber.textContent = day;
                    cell.appendChild(dayNumber);
                    
                    // Make the day clickable
                    cell.addEventListener('click', () => {
                        alert(`You clicked on ${monthNames[month]} ${day}, ${year}`);
                    });
                    
                    // Add some sample events (you'd normally get these from a database)
                    if (day === 15) {
                        const event = document.createElement('div');
                        event.className = 'event';
                        event.textContent = 'Meeting';
                        event.style.backgroundColor = '#000';
                        event.style.color = '#fff';
                        event.style.padding = '2px 5px';
                        event.style.borderRadius = '3px';
                        event.style.fontSize = '10px';
                        event.style.margin = '2px 0';
                        cell.appendChild(event);
                    }
                    
                    if (day === 20) {
                        const event = document.createElement('div');
                        event.className = 'event';
                        event.textContent = 'Lunch';
                        event.style.backgroundColor = '#000';
                        event.style.color = '#fff';
                        event.style.padding = '2px 5px';
                        event.style.borderRadius = '3px';
                        event.style.fontSize = '10px';
                        event.style.margin = '2px 0';
                        cell.appendChild(event);
                    }
                    
                    calendarGrid.appendChild(cell);
                }
            }
            
            // Initial render
            renderCalendar();
        }
        
        // Settings app functionality
        function initSettings() {
            const settingsApp = document.getElementById('settings-app');
            if (!settingsApp) return;
            
            const navItems = settingsApp.querySelectorAll('.settings-nav-item');
            const sections = settingsApp.querySelectorAll('.settings-section');
            
            // Navigation
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    const section = item.getAttribute('data-section');
                    
                    // Update active nav
                    navItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Show selected section
                    sections.forEach(s => {
                        s.classList.remove('active');
                        if (s.id === `${section}-section`) {
                            s.classList.add('active');
                        }
                    });
                });
            });
            
            // Appearance settings
            const themeSelect = document.getElementById('theme-select');
            const bgColor = document.getElementById('bg-color');
            const fontSize = document.getElementById('font-size');
            const fontSizeValue = document.getElementById('font-size-value');
            const applyAppearance = document.getElementById('apply-appearance');
            
            fontSize.addEventListener('input', () => {
                fontSizeValue.textContent = `${fontSize.value}px`;
            });
            
            applyAppearance.addEventListener('click', () => {
                // Apply background color
                document.querySelector('.desktop').style.backgroundColor = bgColor.value;
                
                // Apply theme (this would normally do more)
                const theme = themeSelect.value;
                if (theme === 'dark') {
                    document.documentElement.style.setProperty('--text-color', '#fff');
                    document.documentElement.style.setProperty('--background-color', '#333');
                } else {
                    document.documentElement.style.setProperty('--text-color', '#000');
                    document.documentElement.style.setProperty('--background-color', '#f8f8f8');
                }
                
                // Apply font size
                document.documentElement.style.setProperty('--base-font-size', `${fontSize.value}px`);
                
                alert('Settings applied!');
            });
            
            // Desktop settings
            const iconSize = document.getElementById('icon-size');
            const iconSizeValue = document.getElementById('icon-size-value');
            const showIcons = document.getElementById('show-desktop-icons');
            const applyDesktop = document.getElementById('apply-desktop');
            
            iconSize.addEventListener('input', () => {
                iconSizeValue.textContent = `${iconSize.value}px`;
            });
            
            applyDesktop.addEventListener('click', () => {
                // Apply icon size
                document.querySelectorAll('.icon-image').forEach(icon => {
                    icon.style.width = `${iconSize.value}px`;
                    icon.style.height = `${iconSize.value}px`;
                });
                
                // Toggle desktop icons
                document.querySelector('.desktop-icons').style.display = showIcons.checked ? 'grid' : 'none';
                
                alert('Desktop settings applied!');
            });
            
            // Account settings
            const signOutBtn = settingsApp.querySelector('.account-btn:last-child');
            signOutBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to sign out?')) {
                    document.getElementById('desktop').style.display = 'none';
                    document.querySelector('.login-screen').style.display = 'flex';
                }
            });
            
            // Privacy settings
            const clearDataBtn = document.getElementById('clear-data');
            clearDataBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to clear all data? This cannot be undone.')) {
                    alert('All data has been cleared!');
                }
            });
            
            // About section
            const checkUpdatesBtn = document.getElementById('check-updates');
            checkUpdatesBtn.addEventListener('click', () => {
                checkUpdatesBtn.textContent = 'Checking...';
                setTimeout(() => {
                    checkUpdatesBtn.textContent = 'Check for Updates';
                    alert('Your WebOS is up to date!');
                }, 1500);
            });
        }
        
        // Browser app functionality
        function initBrowser() {
            const browserApp = document.getElementById('browser-app');
            if (!browserApp) return;
            
            const browserIframe = document.getElementById('browser-iframe');
            const urlInput = document.getElementById('url-input');
            const goBtn = document.getElementById('go-btn');
            const backBtn = document.getElementById('back-btn');
            const forwardBtn = document.getElementById('forward-btn');
            const refreshBtn = document.getElementById('refresh-btn');
            const homeBtn = document.getElementById('home-btn');
            const placeholder = document.getElementById('browser-placeholder');
            
            let history = [];
            let currentHistoryIndex = -1;
            
            // Default home URL
            const homeUrl = 'about:blank';
            
            // Load URL function
            function loadUrl(url) {
                // Simple URL validation
                if (!url.startsWith('http://') && !url.startsWith('https://') && url !== 'about:blank') {
                    url = 'https://' + url;
                }
                
                // Show placeholder instead of actually loading URL
                // (normally we would set the iframe src here, but for security in this demo we'll just show a placeholder)
                if (url !== 'about:blank') {
                    placeholder.style.display = 'flex';
                    browserIframe.style.display = 'none';
                    urlInput.value = url;
                    
                    // Add to history
                    if (currentHistoryIndex < history.length - 1) {
                        history = history.slice(0, currentHistoryIndex + 1);
                    }
                    history.push(url);
                    currentHistoryIndex = history.length - 1;
                    
                    // Update back/forward buttons
                    backBtn.disabled = currentHistoryIndex <= 0;
                    forwardBtn.disabled = currentHistoryIndex >= history.length - 1;
                } else {
                    browserIframe.src = url;
                    placeholder.style.display = 'none';
                    browserIframe.style.display = 'block';
                }
            }
            
            // Navigation event handlers
            goBtn.addEventListener('click', () => {
                loadUrl(urlInput.value);
            });
            
            urlInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    loadUrl(urlInput.value);
                }
            });
            
            backBtn.addEventListener('click', () => {
                if (currentHistoryIndex > 0) {
                    currentHistoryIndex--;
                    loadUrl(history[currentHistoryIndex]);
                }
            });
            
            forwardBtn.addEventListener('click', () => {
                if (currentHistoryIndex < history.length - 1) {
                    currentHistoryIndex++;
                    loadUrl(history[currentHistoryIndex]);
                }
            });
            
            refreshBtn.addEventListener('click', () => {
                loadUrl(urlInput.value);
            });
            
            homeBtn.addEventListener('click', () => {
                loadUrl(homeUrl);
            });
            
            // Handle search from the home page
            const searchInput = placeholder.querySelector('.search-input-container input');
            const searchButton = placeholder.querySelector('.search-input-container button');
            
            searchButton.addEventListener('click', () => {
                if (searchInput.value.trim()) {
                    loadUrl(`https://www.google.com/search?q=${encodeURIComponent(searchInput.value)}`);
                }
            });
            
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && searchInput.value.trim()) {
                    loadUrl(`https://www.google.com/search?q=${encodeURIComponent(searchInput.value)}`);
                }
            });
            
            // Quick links
            const quickLinks = placeholder.querySelectorAll('.quick-link');
            quickLinks.forEach(link => {
                link.addEventListener('click', () => {
                    const linkType = link.querySelector('.quick-link-text').textContent.toLowerCase();
                    let url = 'about:blank';
                    
                    switch (linkType) {
                        case 'mail':
                            url = 'https://mail.google.com';
                            break;
                        case 'news':
                            url = 'https://news.google.com';
                            break;
                        case 'maps':
                            url = 'https://maps.google.com';
                            break;
                        case 'shopping':
                            url = 'https://shopping.google.com';
                            break;
                    }
                    
                    loadUrl(url);
                });
            });
            
            // Initialize with the home page
            loadUrl(homeUrl);
        }
        
        // Documents app functionality
        function initDocuments() {
            const documentsApp = document.getElementById('documents-app');
            if (!documentsApp) return;
            
            // Sidebar navigation
            const sidebarItems = documentsApp.querySelectorAll('.sidebar-item');
            sidebarItems.forEach(item => {
                item.addEventListener('click', () => {
                    sidebarItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    // In a real app, this would load the relevant files
                });
            });
            
            // File items
            const fileItems = documentsApp.querySelectorAll('.file-item');
            fileItems.forEach(item => {
                item.addEventListener('click', () => {
                    // In a real app, this would open the file or folder
                    const name = item.querySelector('span').textContent;
                    if (item.classList.contains('folder')) {
                        alert(`Opening folder: ${name}`);
                    } else {
                        alert(`Opening file: ${name}`);
                    }
                });
            });
            
            // Toolbar buttons
            const toolbarBtns = documentsApp.querySelectorAll('.toolbar-btn');
            toolbarBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const action = btn.textContent.trim();
                    alert(`${action} action would be performed here`);
                });
            });
            
            // Search functionality
            const searchInput = documentsApp.querySelector('.search-bar input');
            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.toLowerCase();
                
                fileItems.forEach(item => {
                    const fileName = item.querySelector('span').textContent.toLowerCase();
                    if (fileName.includes(searchTerm) || searchTerm === '') {
                        item.style.display = 'flex';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }
        
        // Photos app functionality
        function initPhotos() {
            const photosApp = document.getElementById('photos-app');
            if (!photosApp) return;
            
            // Photos navigation
            const photosBtns = photosApp.querySelectorAll('.photos-btn');
            photosBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    photosBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    // In a real app, this would switch views
                });
            });
            
            // Photo items
            const photoItems = photosApp.querySelectorAll('.photo-item');
            photoItems.forEach((item, index) => {
                item.addEventListener('click', () => {
                    alert(`Viewing photo ${index + 1}`);
                    // In a real app, this would open a lightbox or detail view
                });
            });
            
            // Search functionality
            const searchInput = photosApp.querySelector('.photos-search');
            searchInput.addEventListener('input', () => {
                // In a real app, this would filter photos
                alert('Search functionality would filter photos here');
                searchInput.value = '';
            });
        }

        // Create a global API for applications to use
        window.NotificationAPI = {
            create: function(appName, title, message, icon) {
                return addNotification(appName, title, message, icon);
            },
            remove: function(id) {
                removeNotification(id);
            },
            clear: function() {
                clearAllNotifications();
            }
        };
        
        // Function to test notifications from different apps
        function testAppNotifications() {
            // Allow apps to send notifications
            // Sample usage for apps:
            setTimeout(() => {
                window.NotificationAPI.create('Browser', 'Download complete', 'Your file has been downloaded successfully.', 'fa-globe');
            }, 20000);
            
            setTimeout(() => {
                window.NotificationAPI.create('Photos', 'Backup complete', 'Your photos have been backed up to the cloud.', 'fa-images');
            }, 25000);
            
            // Example of how terminal app can create a notification
            const terminalInput = document.getElementById('terminal-input');
            if (terminalInput) {
                terminalInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        const command = terminalInput.value;
                        
                        // For demo purposes, create a notification when user types "notify"
                        if (command.startsWith('notify ')) {
                            const message = command.substring(7);
                            window.NotificationAPI.create('Terminal', 'Command executed', message, 'fa-terminal');
                        }
                    }
                });
            }
        }

        // Context Menu System
        function initContextMenuSystem() {
            const contextMenu = document.getElementById('contextMenu');
            
            // Hide context menu on click outside
            document.addEventListener('click', () => {
                hideContextMenu();
            });
            
            // Prevent default context menu and show our custom one
            document.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                
                // Get the clicked element
                const target = e.target.closest('.desktop-icon, .file-item, .taskbar-item, .app-window, .desktop');
                
                if (target) {
                    // Position the context menu
                    showContextMenu(e.clientX, e.clientY, getContextMenuItems(target));
                } else {
                    // For any other area, show a default context menu
                    showContextMenu(e.clientX, e.clientY, getDefaultContextMenuItems());
                }
            });
        }
        
        function showContextMenu(x, y, items) {
            const contextMenu = document.getElementById('contextMenu');
            
            // Clear previous items
            contextMenu.innerHTML = '';
            
            // Add new items
            items.forEach(item => {
                if (item.separator) {
                    const separator = document.createElement('div');
                    separator.className = 'context-menu-separator';
                    contextMenu.appendChild(separator);
                } else {
                    const menuItem = document.createElement('div');
                    menuItem.className = 'context-menu-item';
                    
                    if (item.disabled) {
                        menuItem.classList.add('disabled');
                    }
                    
                    let html = '';
                    
                    if (item.icon) {
                        html += `<i class="fas ${item.icon}"></i>`;
                    }
                    
                    html += item.label;
                    
                    if (item.shortcut) {
                        html += `<span class="keyboard-shortcut">${item.shortcut}</span>`;
                    }
                    
                    menuItem.innerHTML = html;
                    
                    if (!item.disabled && item.action) {
                        menuItem.addEventListener('click', (e) => {
                            e.stopPropagation();
                            hideContextMenu();
                            item.action();
                        });
                    }
                    
                    contextMenu.appendChild(menuItem);
                }
            });
            
            // Position menu
            contextMenu.style.top = `${y}px`;
            contextMenu.style.left = `${x}px`;
            
            // Ensure menu doesn't go off-screen
            const rect = contextMenu.getBoundingClientRect();
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            
            if (rect.right > windowWidth) {
                contextMenu.style.left = `${windowWidth - rect.width}px`;
            }
            
            if (rect.bottom > windowHeight) {
                contextMenu.style.top = `${windowHeight - rect.height}px`;
            }
            
            // Show menu
            contextMenu.classList.add('show');
        }
        
        function hideContextMenu() {
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.classList.remove('show');
        }
        
        function getContextMenuItems(target) {
            // Desktop icon context menu
            if (target.classList.contains('desktop-icon')) {
                const app = target.getAttribute('data-app');
                
                return [
                    {
                        label: `Open ${app}`,
                        icon: 'fa-external-link-alt',
                        action: () => {
                            launchApp(app);
                        }
                    },
                    {
                        label: 'Pin to Taskbar',
                        icon: 'fa-thumbtack',
                        action: () => {
                            alert(`Pin ${app} to taskbar functionality would go here`);
                        }
                    },
                    { separator: true },
                    {
                        label: 'Create Shortcut',
                        icon: 'fa-clone',
                        action: () => {
                            alert(`Create shortcut functionality would go here`);
                        }
                    },
                    {
                        label: 'Rename',
                        icon: 'fa-edit',
                        action: () => {
                            alert(`Rename functionality would go here`);
                        }
                    },
                    { separator: true },
                    {
                        label: 'Delete',
                        icon: 'fa-trash-alt',
                        action: () => {
                            alert(`Delete functionality would go here`);
                        }
                    },
                    { separator: true },
                    {
                        label: 'Properties',
                        icon: 'fa-info-circle',
                        action: () => {
                            alert(`Properties functionality would go here`);
                        }
                    }
                ];
            }
            
            // File item context menu
            if (target.classList.contains('file-item')) {
                const isFolder = target.classList.contains('folder');
                const name = target.querySelector('span').textContent;
                
                return [
                    {
                        label: `Open ${name}`,
                        icon: isFolder ? 'fa-folder-open' : 'fa-file-alt',
                        action: () => {
                            if (isFolder) {
                                alert(`Opening folder: ${name}`);
                            } else {
                                alert(`Opening file: ${name}`);
                            }
                        }
                    },
                    { separator: true },
                    {
                        label: 'Copy',
                        icon: 'fa-copy',
                        shortcut: 'Ctrl+C',
                        action: () => {
                            alert(`Copy functionality would go here`);
                        }
                    },
                    {
                        label: 'Cut',
                        icon: 'fa-cut',
                        shortcut: 'Ctrl+X',
                        action: () => {
                            alert(`Cut functionality would go here`);
                        }
                    },
                    { separator: true },
                    {
                        label: 'Delete',
                        icon: 'fa-trash-alt',
                        shortcut: 'Del',
                        action: () => {
                            alert(`Delete functionality would go here`);
                        }
                    },
                    {
                        label: 'Rename',
                        icon: 'fa-edit',
                        shortcut: 'F2',
                        action: () => {
                            alert(`Rename functionality would go here`);
                        }
                    },
                    { separator: true },
                    {
                        label: 'Properties',
                        icon: 'fa-info-circle',
                        action: () => {
                            alert(`Properties functionality would go here`);
                        }
                    }
                ];
            }
            
            // Taskbar item context menu
            if (target.classList.contains('taskbar-item')) {
                const app = target.getAttribute('data-app');
                const active = activeWindows.includes(app);
                
                return [
                    {
                        label: active ? `Minimize ${app}` : `Open ${app}`,
                        icon: active ? 'fa-window-minimize' : 'fa-external-link-alt',
                        action: () => {
                            if (active) {
                                minimizeApp(app);
                            } else {
                                launchApp(app);
                            }
                        }
                    },
                    {
                        label: 'Close',
                        icon: 'fa-times',
                        disabled: !active,
                        action: () => {
                            if (active) {
                                closeWindow(app);
                            }
                        }
                    },
                    { separator: true },
                    {
                        label: 'Unpin from Taskbar',
                        icon: 'fa-thumbtack',
                        action: () => {
                            alert(`Unpin from taskbar functionality would go here`);
                        }
                    }
                ];
            }
            
            // App window context menu
            if (target.classList.contains('app-window')) {
                const app = target.getAttribute('data-app');
                
                return [
                    {
                        label: 'Minimize',
                        icon: 'fa-window-minimize',
                        action: () => {
                            minimizeApp(app);
                        }
                    },
                    {
                        label: target.classList.contains('maximized') ? 'Restore' : 'Maximize',
                        icon: target.classList.contains('maximized') ? 'fa-window-restore' : 'fa-window-maximize',
                        action: () => {
                            toggleMaximize(app);
                        }
                    },
                    { separator: true },
                    {
                        label: 'Close',
                        icon: 'fa-times',
                        shortcut: 'Alt+F4',
                        action: () => {
                            closeWindow(app);
                        }
                    }
                ];
            }
            
            // Desktop context menu
            if (target.classList.contains('desktop')) {
                return [
                    {
                        label: 'Refresh',
                        icon: 'fa-sync',
                        action: () => {
                            // Simulate refresh effect
                            const desktop = document.getElementById('desktop');
                            desktop.style.opacity = '0.8';
                            setTimeout(() => {
                                desktop.style.opacity = '1';
                            }, 300);
                        }
                    },
                    { separator: true },
                    {
                        label: 'View',
                        icon: 'fa-eye',
                        action: () => {
                            alert('View options would go here');
                        }
                    },
                    {
                        label: 'Sort By',
                        icon: 'fa-sort',
                        action: () => {
                            alert('Sort options would go here');
                        }
                    },
                    { separator: true },
                    {
                        label: 'New',
                        icon: 'fa-plus',
                        action: () => {
                            alert('New item options would go here');
                        }
                    },
                    { separator: true },
                    {
                        label: 'Display Settings',
                        icon: 'fa-desktop',
                        action: () => {
                            launchApp('settings');
                        }
                    },
                    {
                        label: 'Personalize',
                        icon: 'fa-paint-brush',
                        action: () => {
                            launchApp('settings');
                        }
                    }
                ];
            }
            
            // Default context menu for other areas
            return getDefaultContextMenuItems();
        }
        
        function getDefaultContextMenuItems() {
            return [
                {
                    label: 'Back',
                    icon: 'fa-arrow-left',
                    disabled: true
                },
                {
                    label: 'Forward',
                    icon: 'fa-arrow-right',
                    disabled: true
                },
                {
                    label: 'Reload',
                    icon: 'fa-sync',
                    action: () => {
                        window.location.reload();
                    }
                },
                { separator: true },
                {
                    label: 'Save As...',
                    icon: 'fa-save',
                    disabled: true
                },
                {
                    label: 'Print...',
                    icon: 'fa-print',
                    disabled: true
                },
                { separator: true },
                {
                    label: 'View Source',
                    icon: 'fa-code',
                    disabled: true
                },
                {
                    label: 'Inspect',
                    icon: 'fa-search',
                    disabled: true
                }
            ];
        }

        // Function to make window draggable with improved performance
        function makeWindowDraggable(window, handle) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            let isDragging = false;
            
            // Add hardware acceleration hint to improve performance
            window.style.willChange = 'transform';
            window.style.transition = 'box-shadow 0.2s ease';
            
            handle.onmousedown = dragMouseDown;
            
            function dragMouseDown(e) {
                e.preventDefault();
                // Get mouse position at startup
                pos3 = e.clientX;
                pos4 = e.clientY;
                
                // Add visual feedback for dragging
                window.classList.add('dragging');
                window.style.boxShadow = '0 10px 30px rgba(0, 0, 0, 0.3)';
                
                // Bring window to front
                bringWindowToFront(window.getAttribute('data-app'));
                
                // Set dragging state
                isDragging = true;
                
                // Use requestAnimationFrame for smoother animation
                requestAnimationFrame(updatePosition);
                
                // Add mouse move and mouse up event listeners
                document.addEventListener('mousemove', elementDrag);
                document.addEventListener('mouseup', closeDragElement);
            }
            
            function elementDrag(e) {
                e.preventDefault();
                // Calculate new position
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
            }
            
            function updatePosition() {
                if (!isDragging) return;
                
                // Use transform instead of top/left for better performance
                const currentTransform = new DOMMatrix(window.style.transform || 'matrix(1, 0, 0, 1, 0, 0)');
                const translateX = currentTransform.e - pos1;
                const translateY = currentTransform.f - pos2;
                
                window.style.transform = `translate(${translateX}px, ${translateY}px)`;
                
                // Request next frame
                requestAnimationFrame(updatePosition);
            }
            
            function closeDragElement() {
                // Stop moving when mouse button is released
                window.classList.remove('dragging');
                window.style.boxShadow = '';
                isDragging = false;
                
                // Remove event listeners
                document.removeEventListener('mousemove', elementDrag);
                document.removeEventListener('mouseup', closeDragElement);
                
                // Convert transform to top/left to ensure compatibility with maximize/restore
                const rect = window.getBoundingClientRect();
                window.style.top = rect.top + 'px';
                window.style.left = rect.left + 'px';
                window.style.transform = '';
            }
        }

        // Update the time in the main taskbar
        function updateMainClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const mainTimeDisplay = document.getElementById('mainTimeDisplay');
            if (mainTimeDisplay) {
                mainTimeDisplay.textContent = timeString;
            }
        }

        // Call immediately and then every minute
        updateMainClock();
        setInterval(updateMainClock, 60000);

        // Handle main taskbar clicks
        document.querySelectorAll('#mainTaskbar .taskbar-item').forEach(item => {
            item.addEventListener('click', () => {
                alert('Please log in to access applications');
            });
        });

        document.getElementById('mainStartButton').addEventListener('click', () => {
            alert('Please log in to access the Start menu');
        });

        // Add JavaScript to update the time display in the desktop taskbar
        function updateDesktopClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const timeDisplay = document.getElementById('timeDisplay');
            if (timeDisplay) {
                timeDisplay.textContent = timeString;
            }
        }
        
        // Update clock every minute
        updateDesktopClock();
        setInterval(updateDesktopClock, 60000);
    </script>
</body>
</html>